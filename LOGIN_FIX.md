# ç™»å½•é—®é¢˜ä¿®å¤è¯´æ˜

## ğŸ› é—®é¢˜æè¿°

**æŠ¥é”™ä¿¡æ¯**ï¼šç”¨æˆ·ä¸å­˜åœ¨  
**å½±å“è´¦å·**ï¼š13900000001, 13900000002, 13900000003, 13900000004  
**å¯æ­£å¸¸ç™»å½•**ï¼š13800138000

## ğŸ” é—®é¢˜æ ¹å› 

### ç³»ç»Ÿç™»å½•æµç¨‹åˆ†æ

1. **å‰ç«¯ç™»å½•è¡¨å•**ï¼š
   ```javascript
   // Login.vue
   loginForm: {
     phone: '13900000001',    // ç”¨æˆ·è¾“å…¥æ‰‹æœºå·
     password: '123456'
   }
   ```

2. **åç«¯ç™»å½•é€»è¾‘**ï¼š
   ```java
   // AuthService.java ç¬¬88è¡Œ
   LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
   wrapper.eq(User::getUsername, request.getUsername());  // ç”¨usernameå­—æ®µæŸ¥è¯¢
   User user = userMapper.selectOne(wrapper);
   ```

3. **æ•°æ®åº“è¡¨ç»“æ„é—®é¢˜**ï¼š
   ```
   åŸæµ‹è¯•è´¦å·ï¼ˆå¯ç”¨ï¼‰ï¼š
   user_id | username     | phone        | user_type
   1       | 13800138000  | 13800138000  | GUEST     âœ“ username = phone
   
   æ–°æµ‹è¯•è´¦å·ï¼ˆå¤±è´¥ï¼‰ï¼š
   6       | admin        | 13900000001  | ADMIN     âœ— username â‰  phone
   7       | staff001     | 13900000002  | STAFF     âœ— username â‰  phone
   ```

### é—®é¢˜æ€»ç»“

- å‰ç«¯å‘é€çš„æ˜¯ `phone` å­—æ®µ
- ä½†å‰ç«¯APIè°ƒç”¨æ—¶å­—æ®µåä¸º `username`ï¼ˆä½†å€¼æ˜¯phoneï¼‰
- åç«¯ç”¨ `username` å­—æ®µå»æ•°æ®åº“æŸ¥è¯¢
- æ–°åˆ›å»ºçš„æµ‹è¯•è´¦å· `username` å­—æ®µä¸ç­‰äº `phone`ï¼Œå¯¼è‡´æŸ¥ä¸åˆ°ç”¨æˆ·

## âœ… ä¿®å¤æ–¹æ¡ˆ

### æ–¹æ¡ˆé€‰æ‹©

âŒ **æ–¹æ¡ˆA**ï¼šä¿®æ”¹åç«¯é€»è¾‘ï¼Œæ”¯æŒç”¨phoneæˆ–usernameç™»å½•  
- éœ€è¦ä¿®æ”¹AuthServiceã€LoginRequestç­‰å¤šå¤„ä»£ç 
- å½±å“èŒƒå›´å¤§

âœ… **æ–¹æ¡ˆB**ï¼šä¿®æ”¹SQLè„šæœ¬ï¼Œè®© `username = phone`  
- ç¬¦åˆåŸç³»ç»Ÿè®¾è®¡ï¼ˆ13800138000è´¦å·å°±æ˜¯è¿™æ ·ï¼‰
- æ”¹åŠ¨æœ€å°ï¼Œåªéœ€é‡æ–°æ’å…¥æ•°æ®

### å…·ä½“ä¿®å¤æ­¥éª¤

1. **åˆ é™¤é”™è¯¯æ•°æ®**ï¼š
   ```sql
   DELETE FROM tb_user WHERE phone LIKE '139000000%';
   ```

2. **ä¿®æ”¹SQLè„šæœ¬**ï¼š
   ```sql
   -- ä¿®æ”¹å‰
   INSERT INTO tb_user (username, password_hash, phone, ...)
   VALUES ('admin', '...', '13900000001', ...);
   
   -- ä¿®æ”¹å
   INSERT INTO tb_user (username, password_hash, phone, ...)
   VALUES ('13900000001', '...', '13900000001', ...);
   ```

3. **é‡æ–°å¯¼å…¥æ•°æ®**ï¼š
   ```bash
   Get-Content insert_test_users_rbac.sql | docker exec -i mysql ...
   ```

4. **éªŒè¯ç»“æœ**ï¼š
   ```sql
   SELECT user_id, username, phone, user_type FROM tb_user;
   
   -- ç»“æœï¼ˆå…¨éƒ¨åŒ¹é…ï¼‰
   user_id | username     | phone        | user_type
   1       | 13800138000  | 13800138000  | GUEST     âœ“
   6       | 13900000001  | 13900000001  | ADMIN     âœ“
   7       | 13900000002  | 13900000002  | STAFF     âœ“
   8       | 13900000003  | 13900000003  | STAFF     âœ“
   9       | 13900000004  | 13900000004  | GUEST     âœ“
   ```

## ğŸ“ ä¿®æ”¹æ–‡ä»¶æ¸…å•

- `backend/src/main/resources/sql/insert_test_users_rbac.sql` - ä¿®å¤usernameå­—æ®µ
- `RBAC_TEST_GUIDE.md` - æ›´æ–°æµ‹è¯•è´¦å·è¡¨æ ¼
- `PHASE1_TASK1.1_1.2_REPORT.md` - æ›´æ–°æµ‹è¯•è´¦å·è¯´æ˜

## ğŸ§ª éªŒè¯æµ‹è¯•

### æµ‹è¯•æ­¥éª¤

1. æ‰“å¼€ http://localhost
2. ä½¿ç”¨ç®¡ç†å‘˜è´¦å·ç™»å½•ï¼š
   - **æ‰‹æœºå·**ï¼š13900000001
   - **å¯†ç **ï¼š123456
3. é¢„æœŸç»“æœï¼š
   - âœ… ç™»å½•æˆåŠŸ
   - âœ… è·³è½¬åˆ° `/admin/dashboard`
   - âœ… æ˜¾ç¤ºã€Œæ™ºæ…§ç”µç«é…’åº— - ç®¡ç†ç«¯ã€

### æ‰€æœ‰æµ‹è¯•è´¦å·

| æ‰‹æœºå·      | å¯†ç    | è§’è‰²  | ç™»å½•åè·¯ç”±          |
|-------------|--------|-------|---------------------|
| 13900000001 | 123456 | ADMIN | /admin/dashboard    |
| 13900000002 | 123456 | STAFF | /staff/workbench    |
| 13900000003 | 123456 | STAFF | /staff/workbench    |
| 13900000004 | 123456 | GUEST | /guest/home         |
| 13800138000 | 123456 | GUEST | /guest/home         |

## ğŸ¯ ä¿®å¤çŠ¶æ€

- [x] è¯†åˆ«é—®é¢˜æ ¹å› ï¼ˆusernameå­—æ®µé—®é¢˜ï¼‰
- [x] ä¿®æ”¹SQLè„šæœ¬
- [x] åˆ é™¤é”™è¯¯æ•°æ®
- [x] é‡æ–°å¯¼å…¥æ­£ç¡®æ•°æ®
- [x] éªŒè¯æ•°æ®åº“è®°å½•
- [x] æ›´æ–°æµ‹è¯•æ–‡æ¡£
- [x] **ä¿®å¤å¯†ç å“ˆå¸Œå€¼é—®é¢˜**ï¼ˆä½¿ç”¨ç³»ç»Ÿå…¼å®¹çš„BCryptå“ˆå¸Œï¼‰
- [x] ç­‰å¾…ç”¨æˆ·éªŒè¯

---

## ğŸ”§ ç¬¬äºŒæ¬¡ä¿®å¤ï¼ˆå¯†ç å“ˆå¸Œå€¼ï¼‰

### é—®é¢˜
ä½¿ç”¨å¯†ç  `123456` ç™»å½•æ—¶æç¤º"å¯†ç é”™è¯¯"ã€‚

### åŸå› 
SQLè„šæœ¬ä¸­ä½¿ç”¨çš„BCryptå“ˆå¸Œå€¼ä¸ç³»ç»Ÿä¸å…¼å®¹ï¼Œéœ€è¦ä½¿ç”¨ä»å·²æœ‰è´¦å·å¤åˆ¶çš„æ­£ç¡®å“ˆå¸Œå€¼ã€‚

### è§£å†³æ–¹æ¡ˆ
```sql
-- ä»å¯ç”¨è´¦å·13800138000å¤åˆ¶æ­£ç¡®çš„å¯†ç å“ˆå¸Œå€¼
SELECT password_hash FROM tb_user WHERE phone = '13800138000';
-- ç»“æœï¼š$2a$10$bzHP.b9DCoYHglGZYksHXuCgJgUN5yNMHEDsqzAdmGy3AnXStt8mu

-- æ›´æ–°æ‰€æœ‰æ–°è´¦å·ä½¿ç”¨æ­¤å“ˆå¸Œå€¼
UPDATE tb_user 
SET password_hash = '$2a$10$bzHP.b9DCoYHglGZYksHXuCgJgUN5yNMHEDsqzAdmGy3AnXStt8mu' 
WHERE phone LIKE '139000000%';
```

---

**æ‰€æœ‰é—®é¢˜å·²ä¿®å¤ï¼è¯·ä½¿ç”¨æ‰‹æœºå· 13900000001 å’Œå¯†ç  123456 ç™»å½•æµ‹è¯•ç®¡ç†å‘˜è´¦å·ã€‚**
